<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ë¼ì”¨ ë§¤ë§¤ë¹„ì„œ ë§Œì¡±ë„ ì¡°ì‚¬ (1.27 ~ 2.4)</title>
  <style>
    :root{
            --starSize:36px;
      --starGap:8px;
--bg:#f6f7fb;
      --card:#ffffff;
      --text:#141629;
      --muted:#6b7280; /* gray caption */
      --border:rgba(17,24,39,.12);

      /* Bright purple accents */
      --accent:#6565FF;          /* rassi-like bright purple */
      --accent2:#B66CFF;         /* violet */
      --accentGlow:rgba(101,101,255,.18);
      --accentGlow2:rgba(182,108,255,.14);

      --danger:#e11d48;
      --radius:16px;
      --shadow: 0 10px 26px rgba(17,24,39,.10);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
      color:var(--text);
      background: radial-gradient(1100px 650px at 10% 0%, var(--accentGlow), transparent 58%),
                  radial-gradient(900px 650px at 90% 15%, var(--accentGlow2), transparent 58%),
                  radial-gradient(900px 700px at 50% 100%, rgba(101,101,255,.10), transparent 60%),
                  var(--bg);
      min-height:100vh;
      padding:28px 16px 48px;
    }
    .wrap{max-width:860px; margin:0 auto;}
    header{
      margin: 10px 0 18px;
      display:flex; gap:14px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap;
    }
    .title{
      display:flex; flex-direction:column; gap:6px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      flex-wrap:wrap;
    }
    .brandIcon{
      width:44px;
      height:44px;
      flex:0 0 auto;
      border-radius:999px;
      box-shadow: 0 10px 22px rgba(101,101,255,.18);
      overflow:hidden;
    }
    .brandIcon svg{width:100%; height:100%; display:block;}

    h1{
      margin:0;
      font-size: 22px;
      letter-spacing:-.2px;
    }
    .sub{
      margin:0;
      color:var(--muted);
      font-size: 13px;
      line-height:1.45;
    }
    .sub strong{color: var(--accent);}

    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius: 999px;
      background: rgba(255,255,255,.75);
      backdrop-filter: blur(6px);
      box-shadow: var(--shadow);
      font-size: 12px;
      color: var(--muted);
    }
    .badge strong{color:var(--text); font-weight:700;}
    .card{
      border:1px solid var(--border);
      background: rgba(255,255,255,.92);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .inner{padding:28px 18px 20px;}
    .q{
      padding: 16px 0;
      border-top:1px solid rgba(255,255,255,.08);
    }
    .q:first-child{border-top:0; padding-top:0;}
    .q:last-child{padding-bottom:0;}

    /* âœ… FIX: ëª¨ë°”ì¼ì—ì„œ 'í•„ìˆ˜' ë°°ì§€ë§Œ ë‹¤ìŒ ì¤„ë¡œ ë–¨ì–´ì§€ì§€ ì•Šë„ë¡ (flex ì œê±° + inline íë¦„) */
    .q h3{
      margin:0 0 10px;
      font-size: 20px;
      letter-spacing:-.1px;
      line-height: 1.35;
      display:block; /* ê¸°ì¡´ flex ì œê±° */
    }
    .req{
      color: var(--danger);
      font-size: 12px;
      border: 1px solid rgba(225,29,72,.22);
      background: rgba(225,29,72,.06);
      padding: 2px 8px;
      border-radius: 999px;
      display:inline-flex;
      align-items:center;
      white-space: nowrap;
      vertical-align: middle;
      transform: translateY(-1px);
    }

    .hint{
      margin: 6px 0 18px;
      color:var(--muted);
      font-size: 14px;
    }

    /* Star rating (Google in-app style-ish) */
    .rating{
      display:inline-flex;
      flex-direction:column;
      align-items:flex-start;
      gap:6px;
      flex-wrap:nowrap;
    
      max-width:100%;
    }
    .stars{
      display:inline-flex;
      direction: rtl; /* hover fill trick */
      gap: var(--starGap);
      user-select:none;
    }
    .stars input{display:none;}
    .stars label{
      cursor:pointer;
      font-size: var(--starSize);
      line-height: 1;
      color: rgba(17,24,39,.20);
      transition: transform .08s ease, color .12s ease;
      filter: none;
      }
    .stars label:hover{transform: scale(1.08);}
    .stars label:hover,
    .stars label:hover ~ label{
      color: rgba(101,101,255,.95);
    }
    .stars input:checked ~ label{
      color: rgba(101,101,255,.95);
    }

    .scale{display:flex;justify-content:space-between;align-items:center;width:100%;gap:12px;color: var(--muted);font-size: 12px;line-height: 1.4;}
    .scale span{margin:0; white-space:nowrap;}
    .scale span{margin:0; white-space:nowrap;}

    .options{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      margin-top:10px;
    }
    @media (min-width:720px){
      .options{grid-template-columns: 1fr 1fr;}
    }
    .opt{
      border: 1px solid rgba(17,24,39,.12);
      background: rgba(17,24,39,.03);
      border-radius: 12px;
      padding: 10px 12px;
      display:flex; align-items:center; gap:10px;
    }
    .opt input{transform: translateY(1px);}
    textarea{
      width:100%;
      min-height: 110px;
      margin-top: 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(17,24,39,.03);
      color: var(--text);
      padding: 12px 12px;
      outline: none;
      resize: vertical;
    }
    textarea::placeholder{color: rgba(231,236,255,.45);}

    /* Focus + selection polish */
    .stars label:focus-visible{outline: 3px solid rgba(101,101,255,.28); outline-offset: 4px; border-radius: 8px;}
    input[type="radio"]:focus-visible, textarea:focus-visible, button:focus-visible{
      outline: 3px solid rgba(101,101,255,.28);
      outline-offset: 3px;
    }
    .opt:has(input:checked){
      border-color: rgba(101,101,255,.45);
      background: rgba(101,101,255,.08);
      box-shadow: 0 0 0 1px rgba(101,101,255,.14) inset;
    }
    .opt input{accent-color: var(--accent);}

    .actions{
      margin-top:16px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }
    button{
      appearance:none;
      border:0;
      border-radius: 12px;
      padding: 12px 14px;
      font-weight: 700;
      cursor:pointer;
      transition: transform .06s ease, filter .15s ease;
    }
    button:active{transform: translateY(1px);}
    .primary{
      background: linear-gradient(135deg, var(--accent), rgba(182,108,255,.88));
      color:#fff;
      box-shadow: 0 10px 26px rgba(106,125,255,.25);
    }
    .ghost{
      background: rgba(255,255,255,.75);
      color: var(--text);
      border: 1px solid rgba(17,24,39,.12);
    }
    .msg{
      color: var(--muted);
      font-size: 12px;
      line-height: 1.5;
      margin: 6px 0 0;
    }

    .result{
      margin-top:14px;
      border: 1px solid rgba(17,24,39,.12);
      border-radius: 12px;
      background: rgba(17,24,39,.03);
      padding: 12px;
      display:none;
    }
    .result pre{
      margin:0;
      white-space: pre-wrap;
      word-break: break-word;
      font-size: 12px;
      color: rgba(17,24,39,.90);
    }
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(17,24,39,.12);
      background: rgba(17,24,39,.03);
      font-size: 12px;
      color: var(--muted);
    }
    .pill b{color: var(--text);}

    .footer{
      margin-top: 18px;
      color: rgba(107,114,128,.95);
      font-size: 11px;
      line-height:1.6;
    }
    a{color: var(--accent);}

    /* After submit: switch to view page */
    body.submitted .q,
    body.submitted .actions{
      display:none !important;
    }


    body.submitted #survey{ display:none !important; }
    /* Summary (view page) */
    .summary{
      margin-top: 14px;
      padding: 18px;
      border: 1px solid rgba(17,24,39,.10);
      border-radius: 18px;
      background: rgba(255,255,255,.86);
      box-shadow: var(--shadow);
    }
    .summaryHead{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 14px;
      padding-bottom: 12px;
      border-bottom: 1px solid rgba(17,24,39,.08);
      margin-bottom: 14px;
    }
    .summaryKicker{
      font-size: 12px;
      color: rgba(107,114,128,.95);
      margin-bottom: 4px;
    }
    .summaryTitle{
      font-size: 20px;
      margin: 0 0 6px;
      letter-spacing:-0.02em;
      color: var(--text);
          display:flex;
      align-items:center;
      gap:10px;
}
    .doneIcon{
      width: 24px;
      height: 24px;
      flex: 0 0 auto;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      border-radius: 999px;
      box-shadow: 0 10px 22px rgba(101,101,255,.12);
    }
    .doneIcon svg{width:24px; height:24px; display:block;}

    .summarySub{
      margin:0;
      color: rgba(107,114,128,.95);
      font-size: 13px;
      line-height:1.4;
    }
    .summaryMeta{
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:flex-end;
      flex: 0 0 auto;
      min-width: 140px;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(17,24,39,.12);
      background: rgba(255,255,255,.9);
      color: rgba(17,24,39,.86);
      white-space: nowrap;
    }
    .chipPurple{
      border-color: rgba(101,101,255,.25);
      background: rgba(101,101,255,.08);
      color: rgba(36,39,94,.92);
    }
    .summaryBody{
      display:flex;
      flex-direction:column;
      gap: 12px;
    }
    .sumCard{
      border: 1px solid rgba(101,101,255,.28);
      background: rgba(255,255,255,.92);
      border-radius: 16px;
      padding: 14px 14px 12px;
    }
    .sumQ{
      font-size: 14px;
      font-weight: 700;
      margin: 0 0 6px;
      color: rgba(17,24,39,.92);
    }
    .sumHint{
      margin: 0 0 10px;
      font-size: 12px;
      color: rgba(107,114,128,.95);
      line-height: 1.35;
    }
    .starsView{
      display:inline-flex;
      gap: 6px;
      align-items:center;
      user-select:none;
    }
    .starSvg{
      width: 22px;
      height: 22px;
      opacity: .25;
    }
    .starSvg.filled{
      opacity: 1;
      filter: drop-shadow(0 8px 18px rgba(101,101,255,.18));
    }
    .starSvg path{
      fill: rgba(101,101,255,.95);
    }
    .scaleView{
      margin-top: 6px;
      font-size: 12px;
      color: rgba(107,114,128,.95);
    }
    .choiceGrid{
      display:flex;
      flex-wrap:wrap;
      gap: 8px;
    }
    .choicePill{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(17,24,39,.12);
      background: rgba(17,24,39,.03);
      font-size: 13px;
      color: rgba(17,24,39,.88);
    }
    .choicePill.selected{
      border-color: rgba(101,101,255,.35);
      background: rgba(101,101,255,.08);
      color: rgba(36,39,94,.92);
    }
    .checkMini{
      width: 16px;
      height: 16px;
      display:inline-block;
      border-radius: 999px;
      background: rgba(101,101,255,.12);
      position: relative;
    }
    .checkMini:after{
      content:"";
      position:absolute;
      left: 4px; top: 4px;
      width: 7px; height: 4px;
      border-left: 2px solid var(--accent);
      border-bottom: 2px solid var(--accent);
      transform: rotate(-45deg);
    }
    .textBox{
      margin-top: 10px;
      border: 1px solid rgba(17,24,39,.10);
      background: rgba(17,24,39,.03);
      border-radius: 12px;
      padding: 10px 10px;
      font-size: 13px;
      color: rgba(17,24,39,.88);
      white-space: pre-wrap;
      line-height: 1.45;
    }

    /* Success modal */
    .modal{
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 18px;
    }
    .modal.show{display:flex;}
    .modalOverlay{
      position:absolute;
      inset:0;
      background: rgba(17,24,39,.45);
      backdrop-filter: blur(6px);
    }
    .modalCard{
      position: relative;
      width: min(520px, 92vw);
      background: rgba(255,255,255,.96);
      border: 1px solid rgba(17,24,39,.12);
      border-radius: 20px;
      box-shadow: 0 22px 70px rgba(17,24,39,.22);
      padding: 26px 22px 22px;
      text-align: center;
      animation: pop .18s ease-out;
    }
    @keyframes pop{from{transform: translateY(6px) scale(.98); opacity:.6;} to{transform: translateY(0) scale(1); opacity:1;}}
    .modalIcon{
      width: 84px;
      height: 84px;
      margin: 0 auto 10px;
      border-radius: 999px;
      box-shadow: 0 14px 34px rgba(101,101,255,.16);
      display:flex;
      align-items:center;
      justify-content:center;
      background: radial-gradient(120px 120px at 30% 20%, rgba(101,101,255,.16), transparent 60%),
                  rgba(101,101,255,.06);
    }
    .modalIcon svg{width: 64px; height: 64px;}
    .modalText{
      margin: 0 0 16px;
      color: rgba(107,114,128,.95);
      font-size: 14px;
    }
    .modalActions{display:flex; justify-content:center;}
    body.modalOpen{overflow:hidden;}
    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(17,24,39,.92);
      color: #fff;
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 13px;
      line-height: 1.25;
      box-shadow: 0 14px 40px rgba(0,0,0,.25);
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s ease, transform .18s ease;
      z-index: 10000;
      max-width: min(520px, 92vw);
      text-align: center;
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-6px);
    }


    /* âœ… ëª¨ë°”ì¼ í°íŠ¸ ì—… (ë‹¨, ë§ˆì§€ë§‰ ë¬¸í•­ ì„ íƒí•­ëª©(.opt)ì€ í¬ê¸° ìœ ì§€) */
    @media (max-width: 480px){
      .consentRow{ flex-wrap:nowrap; align-items:flex-start; }
      .consentText{ min-width:0; }
    .consentLabel{
      display:inline-flex;
      align-items:flex-start;
      gap:10px;
      cursor: pointer;
      user-select: none;
    }
    .consentLabelText{
      display:inline-block;
    }
      .consentRow input[type=\"checkbox\"]{ margin-top:3px; }
      :root{ --starSize:38px; --starGap:10px; }

      body{ padding:22px 14px 44px; font-size:17px; } /* ì „ì²´ ê¸°ë³¸ ê¸€ì ì•½ê°„ â†‘ */

      h1{ font-size:24px; }
      .sub{ font-size:14px; }

      .q h3{ font-size:20px; }
      .hint{ font-size:15px; }
      .scale{ font-size:13px; }

      .stars label{ font-size: var(--starSize); }

      textarea{ font-size:15px; }
      .msg{ font-size:13px; }
      .footer{ font-size:12px; }

      /* â­ Q5 ì„ íƒí•­ëª© í…ìŠ¤íŠ¸ëŠ” ì›ë˜ í¬ê¸°(16px) ìœ ì§€ */
      .opt{ font-size:16px; }
    
      .consentText{ font-size:15px; }
      .consentHint{ font-size:13px; }

      .consentLabel input[type="checkbox"]{ width:14px; height:14px; }}

    /* Consent (privacy) */
    .consentBox{
      margin-top: 14px;
      padding: 14px 14px;
      border: 1px solid rgba(17,24,39,.12);
      background: rgba(17,24,39,.03);
      border-radius: 14px;
    }
    .consentRow{
      display:flex;
      align-items:flex-start;
      gap:10px;
      flex-wrap:wrap;
    }
    .consentRow input[type="checkbox"]{
      margin-top: 3px;
      width: 14px;
      height: 14px;
      accent-color: var(--accent);
      flex: 0 0 auto;
    }
    .consentText{
      font-size: 14px;
      color: rgba(17,24,39,.92);
      line-height: 1.45;
    }
    .consentText .reqInline{
      color: var(--danger);
      font-weight: 800;
      margin-left: 6px;
    }
    .consentLink{
      display:inline-block;
      margin-left: 8px;
      color: rgba(107,114,128,.95);
      text-decoration: underline;
      text-underline-offset: 3px;
      font-weight: 700;
      cursor: pointer;
      white-space: nowrap;
    }
    .consentHint{
      margin: 8px 0 0;
      font-size: 12px;
      color: rgba(107,114,128,.95);
      line-height: 1.5;
    }

    /* Consent modal content */
    .modalCard.consentCard{
      text-align:left;
      padding: 22px 18px 18px;
      max-height: 78vh;
      overflow:auto;
    }
    .modalCard.consentCard h2{
      margin: 2px 0 10px;
      font-size: 18px;
      letter-spacing:-0.01em;
    }
    .consentDoc{
      font-size: 13px;
      color: rgba(17,24,39,.88);
      line-height: 1.6;
    }
    .consentDoc b{color: rgba(17,24,39,.92);}
    .consentDoc ul{margin: 10px 0 0; padding-left: 18px;}
    .consentDoc li{margin: 6px 0;}

    /* View-mode font bump (+2px) */
    body.submitted #summary{ font-size: 15px; }
    body.submitted #summary .summaryTitle{ font-size: 22px !important; }
    body.submitted #summary .sumQ{ font-size: 16px !important; }
    body.submitted #summary .sumHint{ font-size: 14px !important; }
    body.submitted #summary .scaleView{ font-size: 14px !important; }
    body.submitted #summary .choicePill{ font-size: 15px !important; }
    body.submitted #summary .textBox{ font-size: 15px !important; }

    /* Write-mode spacing + Q5 textarea readability */
    #survey .q{ padding:30px 0 !important; }
    #survey .q:first-child{ padding-top:0 !important; }
    #survey .q:last-child{ padding-bottom:0 !important; }

    /* Write-page: submit button a bit bigger + right aligned */
    #survey .actions{ justify-content:flex-end; }
    #survey .actions .primary{ padding: 14px 18px; }


    /* Only the last-question textarea */
    #q5_reason{ font-size:18px; }
    #q5_reason::placeholder{ color: rgba(107,114,128,.65); }

    @media (max-width: 480px){
      #q5_reason{ font-size:17px; } /* +2px over mobile textarea(15px) */
    }

</style>

  <meta name="theme-color" content="#6565FF" />
  <link rel="icon" href="rassi_icon.svg" type="image/svg+xml" />
  <link rel="icon" href="data:image/png;base64,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" type="image/png" sizes="64x64" />
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <div class="brand">
          <div class="brandIcon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" role="img" aria-label="ë¼ì”¨ ë§¤ë§¤ë¹„ì„œ ì•„ì´ì½˜">
              <circle cx="100" cy="100" r="100" fill="#6565FF"/>
              <!-- Antenna -->
              <line x1="100" y1="46" x2="100" y2="72" stroke="#ffffff" stroke-width="8" stroke-linecap="round"/>
              <circle cx="100" cy="35" r="9" fill="#ffffff"/>

              <!-- Head arc -->
              <path d="M43 132 A57 62 0 0 1 156 132" fill="none" stroke="#ffffff" stroke-width="9" stroke-linecap="round"/>

              <!-- Eyes -->
              <circle cx="78" cy="105" r="5.5" fill="#ffffff"/>
              <circle cx="122" cy="105" r="5.5" fill="#ffffff"/>

              <!-- Smile -->
              <path d="M94 118 Q100 126 106 118" fill="none" stroke="#ffffff" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>

              <!-- Bow tie -->
              <polygon points="90,138 99,132 99,144" fill="#ffffff"/>
              <polygon points="110,138 101,132 101,144" fill="#ffffff"/>
              <rect x="97" y="135" width="6" height="6" rx="1.5" fill="#ffffff"/>
            </svg>
          </div>
          <div>
            <h1>ë¼ì”¨ ë§¤ë§¤ë¹„ì„œ ë§Œì¡±ë„ ì¡°ì‚¬</h1>
            <p class="sub">ê¸°ê°„: <strong>2026-01-27 ~ 2026-02-04</strong><br>ğŸ™Œ ì•ˆë…•í•˜ì„¸ìš”? ë¼ì”¨ ë§¤ë§¤ë¹„ì„œì…ë‹ˆë‹¤.<br>ì•± ê°œì„ ì„ ìœ„í•´ ì„¤ë¬¸ì„ ì°¸ì—¬í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!<br>ì‘ë‹µì€ ë‚´ë¶€ ê°œì„  ëª©ì ìœ¼ë¡œë§Œ í™œìš©ë©ë‹ˆë‹¤.</p>
          </div>
        </div>
      </div>
    </header>

    <form id="survey" class="card" novalidate onsubmit="return false;">
      <div class="inner">

        <section class="q">
          <h3>1) ì¢…í•© ë§Œì¡±ë„ëŠ” ì–´ëŠ ì •ë„ì¸ê°€ìš”?&nbsp;<span class="req">í•„ìˆ˜</span></h3>
          <p class="hint">ì•± ì „ì²´ ê²½í—˜ì„ ê¸°ì¤€ìœ¼ë¡œ í‰ê°€í•´ ì£¼ì„¸ìš”.</p>
          <div class="rating">
            <div class="stars" aria-label="ì¢…í•© ë§Œì¡±ë„ ë³„ì ">
              <!-- direction: rtl ì´ë¯€ë¡œ 5->1 ìˆœì„œ -->
              <input type="radio" id="q1-5" name="q1" value="5" required><label for="q1-5" title="5ì ">â˜…</label>
              <input type="radio" id="q1-4" name="q1" value="4"><label for="q1-4" title="4ì ">â˜…</label>
              <input type="radio" id="q1-3" name="q1" value="3"><label for="q1-3" title="3ì ">â˜…</label>
              <input type="radio" id="q1-2" name="q1" value="2"><label for="q1-2" title="2ì ">â˜…</label>
              <input type="radio" id="q1-1" name="q1" value="1"><label for="q1-1" title="1ì ">â˜…</label>
            </div>
            <div class="scale" aria-hidden="true">
              <span>1. ë§¤ìš° ë¶ˆë§Œì¡±</span><span>5. ë§¤ìš° ë§Œì¡±</span>
            </div>
          </div>
        </section>

        <section class="q">
          <h3>2) ë§¤ë§¤ì‹ í˜¸(ë§¤ìˆ˜/ë§¤ë„/ë³´ìœ )ê°€ íˆ¬ì íŒë‹¨ì— ë„ì›€ì´ ë˜ì—ˆë‚˜ìš”?&nbsp;<span class="req">í•„ìˆ˜</span></h3>
          <p class="hint">ìµœê·¼ ì‚¬ìš© ê²½í—˜ì„ ë– ì˜¬ë ¤ ë‹µí•´ì£¼ì„¸ìš”.</p>
          <div class="rating">
            <div class="stars" aria-label="ë„ì›€ ì—¬ë¶€ ë³„ì ">
              <input type="radio" id="q2-5" name="q2" value="5" required><label for="q2-5" title="5ì ">â˜…</label>
              <input type="radio" id="q2-4" name="q2" value="4"><label for="q2-4" title="4ì ">â˜…</label>
              <input type="radio" id="q2-3" name="q2" value="3"><label for="q2-3" title="3ì ">â˜…</label>
              <input type="radio" id="q2-2" name="q2" value="2"><label for="q2-2" title="2ì ">â˜…</label>
              <input type="radio" id="q2-1" name="q2" value="1"><label for="q2-1" title="1ì ">â˜…</label>
            </div>
            <div class="scale" aria-hidden="true">
              <span>1. ì „í˜€ ë„ì›€ ì•ˆ ë¨</span><span>5. ë§¤ìš° ë„ì›€ ë¨</span>
            </div>
          </div>
        </section>

        <section class="q">
          <h3>3) ì •ë³´ì˜ ì‹ ë¢°ë„(íƒ€ì´ë°/ê·¼ê±°/ì¼ê´€ì„±)ë¥¼ ì–´ë–»ê²Œ í‰ê°€í•˜ì‹œë‚˜ìš”?&nbsp;<span class="req">í•„ìˆ˜</span></h3>
          <p class="hint">ë§¤ìˆ˜/ë§¤ë„ íƒ€ì´ë°ê³¼ ê·¼ê±° ì„¤ëª…ì˜ ë‚©ë“ ì •ë„ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.</p>
          <div class="rating">
            <div class="stars" aria-label="ì‹ ë¢°ë„ ë³„ì ">
              <input type="radio" id="q3-5" name="q3" value="5" required><label for="q3-5" title="5ì ">â˜…</label>
              <input type="radio" id="q3-4" name="q3" value="4"><label for="q3-4" title="4ì ">â˜…</label>
              <input type="radio" id="q3-3" name="q3" value="3"><label for="q3-3" title="3ì ">â˜…</label>
              <input type="radio" id="q3-2" name="q3" value="2"><label for="q3-2" title="2ì ">â˜…</label>
              <input type="radio" id="q3-1" name="q3" value="1"><label for="q3-1" title="1ì ">â˜…</label>
            </div>
            <div class="scale" aria-hidden="true">
              <span>1. ì „í˜€ ì‹ ë¢° ì•ˆ ë¨</span><span>5. ë§¤ìš° ì‹ ë¢°í•¨</span>
            </div>
          </div>
        </section>

        <section class="q">
          <h3>4) ì•± ì‚¬ìš©ì„±(ì°¾ê¸° ì‰¬ì›€/ê°€ë…ì„±/ì•Œë¦¼/ì†ë„)ì— ëŒ€í•œ ë§Œì¡±ë„ëŠ”?&nbsp;<span class="req">í•„ìˆ˜</span></h3>
          <p class="hint">íƒ­ ì´ë™, ê²€ìƒ‰/ê´€ì‹¬ì¢…ëª©, ì•Œë¦¼ ì„¤ì •, ì†ë„/ì•ˆì •ì„± ë“±ì„ ê¸°ì¤€ìœ¼ë¡œ í‰ê°€í•´ ì£¼ì„¸ìš”.</p>
          <div class="rating">
            <div class="stars" aria-label="ì‚¬ìš©ì„± ë³„ì ">
              <input type="radio" id="q4-5" name="q4" value="5" required><label for="q4-5" title="5ì ">â˜…</label>
              <input type="radio" id="q4-4" name="q4" value="4"><label for="q4-4" title="4ì ">â˜…</label>
              <input type="radio" id="q4-3" name="q4" value="3"><label for="q4-3" title="3ì ">â˜…</label>
              <input type="radio" id="q4-2" name="q4" value="2"><label for="q4-2" title="2ì ">â˜…</label>
              <input type="radio" id="q4-1" name="q4" value="1"><label for="q4-1" title="1ì ">â˜…</label>
            </div>
            <div class="scale" aria-hidden="true">
              <span>1. ë§¤ìš° ë¶ˆí¸</span><span>5. ë§¤ìš° í¸í•¨</span>
            </div>
          </div>
        </section>

        <section class="q">
          <h3>5) ê°€ì¥ ê°œì„ ì´ ì‹œê¸‰í•œ ì  1ê°€ì§€ë¥¼ ì„ íƒí•˜ê³ , ì´ìœ ë¥¼ ì ì–´ì£¼ì„¸ìš”.&nbsp;<span class="req">í•„ìˆ˜</span></h3>
          <p class="hint">ì˜ˆ: â€œì•Œë¦¼ì´ ë„ˆë¬´ ìì£¼ ì™€ì„œ ë„ê²Œ ë¨â€, â€œë§¤ë„ ê·¼ê±°ê°€ ë¶€ì¡±í•´ì„œ ë”°ë¼ê°€ê¸° ì–´ë ¤ì›€â€</p>

          <div class="options" role="group" aria-label="ê°œì„  í•­ëª© ì„ íƒ">
            <label class="opt"><input type="radio" name="q5" value="ì‹ í˜¸ ì •í™•ë„/íƒ€ì´ë°" required> ì‹ í˜¸ ì •í™•ë„/íƒ€ì´ë°</label>
            <label class="opt"><input type="radio" name="q5" value="ì‹ í˜¸ ê·¼ê±° ì„¤ëª…(ì™œ ë§¤ìˆ˜/ë§¤ë„ì¸ì§€)" required> ì‹ í˜¸ ê·¼ê±° ì„¤ëª…(ì™œ ë§¤ìˆ˜/ë§¤ë„ì¸ì§€)</label>
            <label class="opt"><input type="radio" name="q5" value="ì•Œë¦¼(ë¹ˆë„/ë‚´ìš©/ë„ì°©)" required> ì•Œë¦¼(ë¹ˆë„/ë‚´ìš©/ë„ì°©)</label>
            <label class="opt"><input type="radio" name="q5" value="í™”ë©´ êµ¬ì„±/ê°€ë…ì„±" required> í™”ë©´ êµ¬ì„±/ê°€ë…ì„±</label>
            <label class="opt"><input type="radio" name="q5" value="ì¢…ëª© íƒìƒ‰/ê²€ìƒ‰/ê´€ì‹¬ì¢…ëª©" required> ì¢…ëª© íƒìƒ‰/ê²€ìƒ‰/ê´€ì‹¬ì¢…ëª©</label>
            <label class="opt"><input type="radio" name="q5" value="ê¸°íƒ€" required> ê¸°íƒ€</label>
          </div>

          <textarea id="q5_reason" name="q5_reason" placeholder="ì´ìœ (í•„ìˆ˜): ì–´ë–¤ ìƒí™©ì—ì„œ ë¶ˆí¸/ì•„ì‰¬ì› ëŠ”ì§€ êµ¬ì²´ì ìœ¼ë¡œ ì ì–´ì£¼ì„¸ìš”." required></textarea>
        </section>

        <section class="consentBox" aria-label="ì„¤ë¬¸ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜">
          <div class="consentRow">
            <div class="consentText">
              <label for="consent" class="consentLabel">
                <input type="checkbox" id="consent" name="consent" required />
                <span class="consentLabelText">ì„¤ë¬¸ ë‚´ìš© ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤</span>
              </label>
              <span class="reqInline">í•„ìˆ˜</span>
              <a href="#" class="consentLink" id="openConsent">ì „ë¬¸ë³´ê¸°</a>
              <div class="consentHint">ì‘ë‹µ ë‚´ìš©ì€ ì„œë¹„ìŠ¤ ê°œì„  ëª©ì ì— í•œí•´ ë‚´ë¶€ì—ì„œë§Œ í™œìš©ë˜ë©°, ì™¸ë¶€ì— ì œê³µë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
            </div>
          </div>
        </section>

        <div class="actions">
          <div class="row">
            <button type="submit" class="primary">ì œì¶œí•˜ê¸°</button>
          </div>
        </div>

        <p class="msg" id="msg"></p>

        <div class="result" id="resultBox" aria-live="polite">
          <pre id="resultText"></pre>
          <div class="row" style="margin-top:10px;">
            <button type="button" class="ghost" id="copyBtn">JSON ë³µì‚¬</button>
            <button type="button" class="ghost" id="downloadBtn">JSON íŒŒì¼ ì €ì¥</button>
          </div>
          <p class="footer">â€» debug=1ì—ì„œë§Œ ì´ ì˜ì—­ì´ ë³´ì…ë‹ˆë‹¤. ì „ì†¡ ì„±ê³µ ì—¬ë¶€ëŠ” Apps Script ì‹¤í–‰ ê¸°ë¡/ì‹œíŠ¸ì—ì„œ í™•ì¸í•˜ì„¸ìš”.</p>
        </div>

      </div>
    </form>

    <section id="summary" class="summary" style="display:none;" aria-live="polite">
      <div class="summaryHead">
        <div>
          <h2 class="summaryTitle"><span class="doneIcon" aria-hidden="true"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="12" fill="rgba(101,101,255,.12)"/><path d="M6.8 12.6l3.1 3.1L17.6 8.3" fill="none" stroke="var(--accent)" stroke-width="2.6" stroke-linecap="round" stroke-linejoin="round"/></svg></span>ì˜ê²¬ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.</h2>
        </div>
      </div>
      <div id="summaryBody" class="summaryBody"></div>
    </section>
</div>

  <!-- Success Modal -->
  <div id="successModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="successTitle">
    <div class="modalOverlay" data-close="1"></div>
    <div class="modalCard" role="document">
      <div class="modalIcon" aria-hidden="true">
        <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
          <circle cx="32" cy="32" r="28" fill="rgba(101,101,255,.12)"/>
          <path d="M20 33.5l8 8 16-20" fill="none" stroke="var(--accent)" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <h2 id="successTitle">ì„¤ë¬¸ì´ ì™„ë£ŒëìŠµë‹ˆë‹¤.</h2>
      <p class="modalText">ê°ì‚¬í•©ë‹ˆë‹¤.</p>
      <div class="modalActions">
        <button type="button" class="btn primary" id="modalCloseBtn">í™•ì¸</button>
      </div>
    </div>
  </div>

<!-- Consent Modal -->
  <div id="consentModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="consentTitle">
    <div class="modalOverlay" data-close="1"></div>


    <div class="modalCard consentCard" role="document">
      <h2 id="consentTitle">ì„¤ë¬¸ ë‚´ìš© ìˆ˜ì§‘ ë° ì´ìš© ì•ˆë‚´</h2>
      <div class="consentDoc">
        <ul>
          <li><b>ìˆ˜ì§‘ í•­ëª©</b>: ì„¤ë¬¸ ì‘ë‹µ ë‚´ìš©(ë³„ì  ë° ì„œìˆ í˜• ì˜ê²¬), ì œì¶œ ì‹œê°</li>
          <li><b>ì´ìš© ëª©ì </b>: ì„œë¹„ìŠ¤ í’ˆì§ˆ ê°œì„  ë° ë‚´ë¶€ ë¶„ì„</li>
          <li><b>ë³´ìœ  ë° ì´ìš© ê¸°ê°„</b>: ìˆ˜ì§‘ì¼ë¡œë¶€í„° <b>20ì¼</b> ì´ë‚´ ì•ˆì „í•˜ê²Œ íŒŒê¸°</li>
          <li><b>ì œ3ì ì œê³µ</b>: <b>ì—†ìŒ</b> (ì™¸ë¶€ ì œê³µí•˜ì§€ ì•ŠìŒ)</li>
          <li><b>ë™ì˜ ê±°ë¶€ ê¶Œë¦¬</b>: ë™ì˜í•˜ì§€ ì•Šì„ ê¶Œë¦¬ê°€ ìˆìœ¼ë©°, ë™ì˜í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì„¤ë¬¸ ì œì¶œì´ ì œí•œë©ë‹ˆë‹¤(í•„ìˆ˜).</li>
        </ul>
        <p style="margin:12px 0 0;">
          â€» ë³¸ ì„¤ë¬¸ì€ ë‚´ë¶€ ê°œì„  ëª©ì ì˜ ì˜ê²¬ ìˆ˜ì§‘ì´ë©°, ê°œì¸ì„ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ì •ë³´(ì´ë¦„/ì—°ë½ì²˜ ë“±)ëŠ” ìš”ì²­í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
        </p>
      </div>
      <div class="modalActions" style="margin-top:14px;">
        <button type="button" class="btn primary" id="consentCloseBtn">í™•ì¸</button>
      </div>
    </div>
  </div>



  <div id="toast" class="toast" aria-live="polite" aria-atomic="true"></div>

<script>
(() => {
  const form = document.getElementById('survey');
  const msg = document.getElementById('msg');
  const toast = document.getElementById('toast');
  function showToast(text){
    if (!toast) return;
    toast.textContent = text;
    toast.classList.add('show');
    clearTimeout(toast.__t);
    toast.__t = setTimeout(() => toast.classList.remove('show'), 1600);
  }


  // Debug panel (hidden unless ?debug=1)
  const resultBox = document.getElementById('resultBox');
  const resultText = document.getElementById('resultText');
  const copyBtn = document.getElementById('copyBtn');
  const downloadBtn = document.getElementById('downloadBtn');
  // Consent modal
  const consentLink = document.getElementById('openConsent');
  const consentModal = document.getElementById('consentModal');
  const consentCloseBtn = document.getElementById('consentCloseBtn');

  function openConsentModal(){
    if (!consentModal) return;
    consentModal.classList.add('show');
    consentModal.setAttribute('aria-hidden','false');
    document.body.classList.add('modalOpen');
    if (consentCloseBtn) consentCloseBtn.focus();
  }
  function closeConsentModal(){
    if (!consentModal) return;
    consentModal.classList.remove('show');
    consentModal.setAttribute('aria-hidden','true');
    document.body.classList.remove('modalOpen');
  }

  if (consentLink) {
    consentLink.addEventListener('click', (e) => {
      e.preventDefault();
      openConsentModal();
    });
  }
  if (consentCloseBtn) consentCloseBtn.addEventListener('click', closeConsentModal);
  if (consentModal) {
    consentModal.addEventListener('click', (e) => {
      const t = e.target;
      if (t && t.dataset && t.dataset.close) closeConsentModal();
    });
  }


  // View-page summary
  const summary = document.getElementById('summary');
  const summaryBody = document.getElementById('summaryBody');
  const submittedAtChip = document.getElementById('submittedAtChip');
  const avgChip = document.getElementById('avgChip');

  const DEBUG = new URLSearchParams(window.location.search).has('debug');
  const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycbybBNuhCaHetfrmAihsBlEW_5lwjsaugnuzM7JQb834X8v8DmoCrwJxVQvhVwLqdleQ0w/exec";

  let submitted = false;

  // Debug visibility
  if (resultBox && !DEBUG) {
    resultBox.style.display = "none";
  }

  // ===== Modal (bulletproof) =====
  function ensureModal() {
    let modal = document.getElementById('successModal');
    if (!modal) {
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div id="successModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="successTitle">
          <div class="modalOverlay" data-close="1"></div>
          <div class="modalCard" role="document">
            <div class="modalIcon" aria-hidden="true">
              <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                <circle cx="32" cy="32" r="28" fill="rgba(101,101,255,.12)"/>
                <path d="M20 33.5l8 8 16-20" fill="none" stroke="var(--accent)" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <h2 id="successTitle">ì„¤ë¬¸ì´ ì™„ë£ŒëìŠµë‹ˆë‹¤.</h2>
            <p class="modalText">ê°ì‚¬í•©ë‹ˆë‹¤.</p>
            <div class="modalActions">
              <button type="button" class="btn primary" id="modalCloseBtn">í™•ì¸</button>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(wrapper.firstElementChild);
      modal = document.getElementById('successModal');
    }

    // wire once
    if (modal && modal.dataset.wired !== "1") {
      modal.dataset.wired = "1";
      const closeBtn = document.getElementById('modalCloseBtn');

      const closeModal = () => {
        modal.classList.remove('show');
        modal.setAttribute('aria-hidden','true');
        document.body.classList.remove('modalOpen');
      };

      const openModal = () => {
        modal.classList.add('show');
        modal.setAttribute('aria-hidden','false');
        document.body.classList.add('modalOpen');
        if (closeBtn) closeBtn.focus();
      };

      modal.__open = openModal;
      modal.__close = closeModal;

      if (closeBtn) closeBtn.addEventListener('click', closeModal);
      modal.addEventListener('click', (e) => {
        const t = e.target;
        if (t && t.dataset && t.dataset.close) closeModal();
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('show')) closeModal();
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && consentModal && consentModal.classList.contains('show')) closeConsentModal();
      });
    }

    return modal;
  }

  function openModal() {
    const modal = ensureModal();
    if (modal && modal.__open) modal.__open();
  }

  // ===== Helpers =====
  function getValue(name) {
    const el = form.querySelector(`[name="${name}"]:checked`);
    return el ? el.value : "";
  }

  function validate() {
    msg.textContent = "";
    msg.style.color = "";
    const required = form.querySelectorAll('[required]');
    for (const el of required) {
      if (el.type === 'radio') {
        const group = el.name;
        if (!form.querySelector(`[name="${group}"]:checked`)) {
          return { ok:false, focus: form.querySelector(`[name="${group}"]`) };
        }
      } else if (el.type === 'checkbox') {
        if (!el.checked) {
          return { ok:false, focus: el };
        }
      } else if (!el.value.trim()) {
        return { ok:false, focus: el };
      }
    }
    return { ok:true };
  }

  function buildResult() {
    const now = new Date();
    const pad = n => String(n).padStart(2,'0');
    const ts = `${now.getFullYear()}-${pad(now.getMonth()+1)}-${pad(now.getDate())} ${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;

    const data = {
      survey: "ë¼ì”¨ ë§¤ë§¤ë¹„ì„œ ë§Œì¡±ë„ ì¡°ì‚¬",
      period: "2026-01-27 ~ 2026-02-04",
      submitted_at: ts,
      answers: {
        q1_overall: Number(getValue("q1")),
        q2_helpful: Number(getValue("q2")),
        q3_trust: Number(getValue("q3")),
        q4_usability: Number(getValue("q4")),
        q5_improvement_area: getValue("q5"),
        q5_reason: (form.q5_reason.value || "").trim()
      }
    };

    const avg = (data.answers.q1_overall + data.answers.q2_helpful + data.answers.q3_trust + data.answers.q4_usability) / 4;
    data.metrics = { rating_average_4q: Number(avg.toFixed(2)) };
    return data;
  }

  function sendToWebhook(data) {
    if (!WEBHOOK_URL) return null;
    const payload = JSON.stringify(data);

    try {
      if (navigator.sendBeacon) {
        // Apps Script doPost(e)ì—ì„œ e.postData.contentsë¡œ ì½ì„ ìˆ˜ ìˆë„ë¡ plain textë¡œ ì „ì†¡
        const blob = new Blob([payload], { type: "text/plain;charset=UTF-8" });
        const ok = navigator.sendBeacon(WEBHOOK_URL, blob);
        if (ok) return "sendBeacon";
      }
    } catch (_) {}

    try {
      fetch(WEBHOOK_URL, {
        method: "POST",
        mode: "no-cors",
        body: payload
      });
      return "fetch(no-cors)";
    } catch (_) {}

    return null;
  }

  function lockForm() {
    document.body.classList.add('submitted');
    // Disable everything to prevent edits
    form.querySelectorAll('input, textarea, button').forEach(el => {
      // keep debug buttons usable in debug mode
      if (DEBUG && (el === copyBtn || el === downloadBtn)) return;
      el.disabled = true;
    });
  }

  function starIcons(score) {
    const s = Number(score || 0);
    const svg = (filled) => `
      <svg class="starSvg ${filled ? 'filled' : ''}" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path>
      </svg>`;
    let out = '';
    for (let i=1;i<=5;i++) out += svg(i<=s);
    return out;
  }

  function renderSummary(data) {
    const a = data.answers || {};
    const areaLabels = [
      "ì‹ í˜¸ ì •í™•ë„/íƒ€ì´ë°",
      "ì‹ í˜¸ ê·¼ê±° ì„¤ëª…(ì™œ ë§¤ìˆ˜/ë§¤ë„ì¸ì§€)",
      "ì•Œë¦¼(ë¹ˆë„/ë‚´ìš©/ë„ì°©)",
      "í™”ë©´ êµ¬ì„±/ê°€ë…ì„±",
      "ì¢…ëª© íƒìƒ‰/ê²€ìƒ‰/ê´€ì‹¬ì¢…ëª©",
      "ê¸°íƒ€"
    ];
    const selected = a.q5_improvement_area || "";
    const pills = areaLabels.map(lbl => `
      <span class="choicePill ${lbl===selected ? 'selected' : ''}">
        ${lbl===selected ? '<span class="checkMini" aria-hidden="true"></span>' : ''}
        ${lbl}
      </span>
    `).join("");

    return `
      <div class="sumCard">
        <div class="sumQ">1) ì¢…í•© ë§Œì¡±ë„ëŠ” ì–´ëŠ ì •ë„ì¸ê°€ìš”?</div>
        <div class="sumHint">ì•± ì „ì²´ ê²½í—˜ì„ ê¸°ì¤€ìœ¼ë¡œ í‰ê°€í•´ ì£¼ì„¸ìš”.</div>
        <div class="starsView" aria-label="ë³„ì  ${a.q1_overall || 0}ì ">${starIcons(a.q1_overall)}</div>
        <div class="scaleView">1. ë§¤ìš° ë¶ˆë§Œì¡±  Â·  5. ë§¤ìš° ë§Œì¡±</div>
      </div>

      <div class="sumCard">
        <div class="sumQ">2) ë§¤ë§¤ì‹ í˜¸(ë§¤ìˆ˜/ë§¤ë„/ë³´ìœ )ê°€ íˆ¬ì íŒë‹¨ì— ë„ì›€ì´ ë˜ì—ˆë‚˜ìš”?</div>
        <div class="sumHint">ìµœê·¼ ì‚¬ìš© ê²½í—˜ì„ ë– ì˜¬ë ¤ ë‹µí•´ì£¼ì„¸ìš”.</div>
        <div class="starsView" aria-label="ë³„ì  ${a.q2_helpful || 0}ì ">${starIcons(a.q2_helpful)}</div>
        <div class="scaleView">1. ì „í˜€ ë„ì›€ ì•ˆ ë¨  Â·  5. ë§¤ìš° ë„ì›€ ë¨</div>
      </div>

      <div class="sumCard">
        <div class="sumQ">3) ì •ë³´ì˜ ì‹ ë¢°ë„(íƒ€ì´ë°/ê·¼ê±°/ì¼ê´€ì„±)ë¥¼ ì–´ë–»ê²Œ í‰ê°€í•˜ì‹œë‚˜ìš”?</div>
        <div class="sumHint">ë§¤ìˆ˜/ë§¤ë„ íƒ€ì´ë°ê³¼ ê·¼ê±° ì„¤ëª…ì˜ ë‚©ë“ ì •ë„ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.</div>
        <div class="starsView" aria-label="ë³„ì  ${a.q3_trust || 0}ì ">${starIcons(a.q3_trust)}</div>
        <div class="scaleView">1. ì „í˜€ ì‹ ë¢° ì•ˆ ë¨  Â·  5. ë§¤ìš° ì‹ ë¢°í•¨</div>
      </div>

      <div class="sumCard">
        <div class="sumQ">4) ì•± ì‚¬ìš©ì„±(ì°¾ê¸° ì‰¬ì›€/ê°€ë…ì„±/ì•Œë¦¼/ì†ë„)ì— ëŒ€í•œ ë§Œì¡±ë„ëŠ”?</div>
        <div class="sumHint">íƒ­ ì´ë™, ê²€ìƒ‰/ê´€ì‹¬ì¢…ëª©, ì•Œë¦¼ ì„¤ì •, ì†ë„/ì•ˆì •ì„± ë“±ì„ ê¸°ì¤€ìœ¼ë¡œ í‰ê°€í•´ ì£¼ì„¸ìš”.</div>
        <div class="starsView" aria-label="ë³„ì  ${a.q4_usability || 0}ì ">${starIcons(a.q4_usability)}</div>
        <div class="scaleView">1. ë§¤ìš° ë¶ˆí¸  Â·  5. ë§¤ìš° í¸í•¨</div>
      </div>

      <div class="sumCard">
        <div class="sumQ">5) ê°€ì¥ ê°œì„ ì´ ì‹œê¸‰í•œ ì  1ê°€ì§€ë¥¼ ì„ íƒí•˜ê³ , ì´ìœ ë¥¼ ì ì–´ì£¼ì„¸ìš”.</div>
        <div class="sumHint">ì„ íƒí•œ í•­ëª©ê³¼ í•¨ê»˜, êµ¬ì²´ì ì¸ ìƒí™©ì„ ì ì–´ì£¼ì‹œë©´ ê°œì„ ì— í° ë„ì›€ì´ ë©ë‹ˆë‹¤.</div>
        <div class="choiceGrid" aria-label="ì„ íƒ í•­ëª©">${pills}</div>
        ${a.q5_reason ? `<div class="textBox">${String(a.q5_reason)}</div>` : ``}
      </div>
    `;
  }

  form.addEventListener('submit', (e) => {
    e.preventDefault();
    if (submitted) return;

    const v = validate();
    if (!v.ok) {
      msg.textContent = "í•„ìˆ˜ ë¬¸í•­ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
      msg.style.color = "rgba(225,29,72,1)";
      showToast("í•„ìˆ˜ ë¬¸í•­ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
if (v.focus) v.focus.scrollIntoView({behavior:'smooth', block:'center'});
      return;
    }

    const data = buildResult();
    const sentVia = sendToWebhook(data);

    // View-page switch
    lockForm();
    if (summary && summaryBody) {
      summaryBody.innerHTML = renderSummary(data);
      summary.style.display = "block";
      window.scrollTo({top:0, behavior:'smooth'});
    }
    if (submittedAtChip) submittedAtChip.textContent = "ì œì¶œ ì‹œê° Â· " + (data.submitted_at || "");
    if (avgChip) avgChip.textContent = "í‰ê·  Â· " + ((data.metrics && data.metrics.rating_average_4q) ? data.metrics.rating_average_4q : "-") + "/5";

    // Debug panel
    if (DEBUG && resultBox && resultText) {
      resultText.textContent = JSON.stringify(data, null, 2);
      resultBox.style.display = "block";
      msg.textContent = sentVia ? `ì œì¶œ ì™„ë£Œ! (debug) ì „ì†¡ ì‹œë„ë¨: ${sentVia}` : "ì œì¶œ ì™„ë£Œ! (debug)";
      msg.style.color = "rgba(107,114,128,.95)";
    } else {
      // ì¼ë°˜ ì‚¬ìš©ìì—ê² í…ìŠ¤íŠ¸ ì•ˆë‚´ ëŒ€ì‹  ëª¨ë‹¬ë¡œë§Œ í”¼ë“œë°±
      msg.textContent = "";
    }

    openModal();
    submitted = true;
  });

  if (copyBtn) {
    copyBtn.addEventListener('click', async () => {
      if (!DEBUG || !resultText) return;
      try {
        await navigator.clipboard.writeText(resultText.textContent);
        msg.textContent = "JSONì„ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆì–´ìš”.";
        msg.style.color = "rgba(107,114,128,.95)";
      } catch (err) {
        msg.textContent = "ë³µì‚¬ ì‹¤íŒ¨: ë¸Œë¼ìš°ì € ê¶Œí•œì„ í™•ì¸í•´ ì£¼ì„¸ìš”.";
        msg.style.color = "rgba(225,29,72,1)";
      }
    });
  }

  if (downloadBtn) {
    downloadBtn.addEventListener('click', () => {
      if (!DEBUG || !resultText) return;
      const blob = new Blob([resultText.textContent], {type: "application/json;charset=utf-8"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = "rassi_survey_2026-01-27_2026-02-04.json";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });
  }
})();
</script>


      

</body>
</html>
